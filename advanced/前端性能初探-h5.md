# 前端性能优化初探-h5版

## 为什么要进⾏性能优化？
> 虽然有一个所谓的8秒规则打开一个网页，用户有不同程度的耐心。作为
调查显示，如果一个网页加载时间超过4秒，流失率可能达到25%。一秒钟
延迟或3秒等待会使客户满意度降低16%。尤其是互联网用户越来越多
知情人士表示，他们对用户体验和网站加载速度会有更高的要求 
成为网站收入的关键因素。
----[性能优化白皮书](https://www.cdnetworks.com/wp-content/uploads/2019/02/CDNetworks-Content-Acceleration-White-Paper.pdf)
- 57%的⽤户更在乎⽹⻚在3秒内是否完成加载
-  52%的在线⽤户认为⽹⻚打开速度影响到他们对⽹站的忠实度
- 每慢1秒造成⻚⾯ PV(页面浏览量或点击量) 降低11%，⽤户满意度也随之降低降低16%
- 近半数移动⽤户因为在10秒内仍未打开⻚⾯从⽽放弃

## http缓存
首先了解一下缓存的优先级，由低到高
###  `last-modified / if-modified-since`

这是⼀组请求/相应头

响应头：
last-modified: Wed, 16 May 2020 02:57:16 GMT

请求头：
if-modified-since: Wed, 16 May 2020 05:55:38 GMT

服务器端返回资源时，如果头部带上了 last-modified，那么
资源下次请求时就会把值加⼊到请求头 if-modified-since
中，服务器可以对⽐这个值，确定资源是否发⽣变化，如果
没有发⽣变化，则返回 304。

### `etag / if-none-match`
这也是⼀组请求/相应头 响应头：

etag: "D5FC8B85A045FF720547BC36FC872550"

请求头：

if-none-match: "D5FC8B85A045FF720547BC36FC872550"

原理类似，服务器端返回资源时，如果头部带上了 etag，那么资源下
次请求时就会把值加⼊到请求头 if-none-match 中，服务器可以对⽐
这个值，确定资源是否发⽣变化，如果没有发⽣变化，则返回 304。

### `expires`
expires: Thu, 16 May 2019 03:05:59 GMT

在 http 头中设置⼀个过期时间，在这个过期时间之前，浏览器的请求都不会发出，⽽是⾃动从缓存中读取⽂件，除⾮缓存被清空，或者强制刷新。缺陷在于，服务器时间和⽤户端时间可能存在不⼀致，所以 HTTP/1.1 加⼊了 cache-control 头来改进这个问题。

### `cache-control`
设置过期的时间⻓度（秒），在这个时间范围内，浏览器请求都会直
接读缓存。当 expires 和 cache-control 都存在时，cache-control 的优先级更⾼。

## 一些概念
- `TTFB` Time To First Byte, ⾸字节
时间
- `FP` First Paint, ⾸次绘制
- `FCP` First Contentful Paint, ⾸次
有内容的绘制
- `FMP` First Meaningful Paint, ⾸
次有意义的绘制
- `TTI` Time To Interactive, 可交互
时间
- `Long tasks` 超过了 50ms 的任务
- `SSR&&CSR` 服务端渲染和客户端渲染
- `Isomorphic JavaScript` 同构化